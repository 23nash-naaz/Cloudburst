-- SQL code to create the table
CREATE TABLE IF NOT EXISTS cloudbursts (
    Date DATE,
    State TEXT,
    District TEXT,
    Rainfall_mm INTEGER,
    Temp_C INTEGER,
    Humidity_percent INTEGER,
    Wind_kmh INTEGER,
    Cloudburst INTEGER,
    Impacts TEXT
);

-- SQL code to insert the dataset (run this after creating the table)
INSERT INTO cloudbursts (Date, State, District, Rainfall_mm, Temp_C, Humidity_percent, Wind_kmh, Cloudburst, Impacts) VALUES
('2023-06-24', 'Himachal Pradesh', 'Chamba', 120, 22, 85, 15, 1, '~25 cattle washed away, crops damaged'),
('2023-06-10', 'Himachal Pradesh', 'Mandi', 110, 23, 82, 12, 1, 'Bridge damaged, road washed away'),
('2023-06-13', 'Himachal Pradesh', 'Mandi', 105, 21, 88, 14, 1, '1 cattle killed, shops/cars washed away'),
('2023-06-25', 'Himachal Pradesh', 'Hamirpur', 130, 20, 90, 16, 1, '6 homes flooded, school damaged'),
('2023-06-25', 'Himachal Pradesh', 'Shimla', 115, 22, 84, 13, 1, 'HEP penstock damaged, cowshed/shop damaged'),
('2023-06-25', 'Himachal Pradesh', 'Kullu', 125, 21, 86, 15, 1, '10 vehicles washed away'),
('2023-06-25', 'Himachal Pradesh', 'Mandi', 140, 23, 89, 17, 1, '3 vehicles/home/shop damaged'),
('2023-06-25', 'Himachal Pradesh', 'Mandi', 110, 22, 85, 14, 1, '~200 tourists rescued'),
('2023-06-25', 'Himachal Pradesh', 'Mandi', 135, 21, 87, 16, 1, '1 woman/cowshed washed away, tourists stranded'),
('2023-06-25', 'Himachal Pradesh', 'Solan', 120, 24, 83, 12, 1, '~36 sheep washed away, roads damaged'),
('2023-07-09', 'Himachal Pradesh', 'Kullu', 150, 20, 92, 18, 1, '~100 beegha land damaged, bridges washed away'),
('2023-07-09', 'Himachal Pradesh', 'Kullu', 130, 21, 88, 15, 1, '7 homes damaged, farmlands affected'),
('2023-07-09', 'Himachal Pradesh', 'Kullu', 140, 22, 90, 16, 1, 'Flash flood, no detailed damage'),
('2023-07-09', 'Himachal Pradesh', 'Mandi', 125, 23, 85, 14, 1, '70 shops affected, 130 families impacted'),
('2023-07-10', 'Himachal Pradesh', 'Solan', 135, 21, 87, 15, 1, '~24 vehicles impacted, crops damaged'),
('2023-07-10', 'Himachal Pradesh', 'Kullu', 110, 22, 84, 13, 1, 'Water supply damaged, road damaged'),
('2023-07-10', 'Himachal Pradesh', 'Kullu', 120, 20, 86, 14, 1, '250 fruit plants washed away'),
('2023-07-14', 'Himachal Pradesh', 'Kullu', 145, 23, 89, 17, 1, '2 homes/5 cowsheds washed away'),
('2023-07-16', 'Himachal Pradesh', 'Shimla', 130, 21, 88, 16, 1, '~24 homes flooded, car/fishery washed away'),
('2023-07-17', 'Himachal Pradesh', 'Kullu', 140, 22, 90, 15, 1, '1 death, 3 injuries, 10 vehicles/homes damaged'),
('2023-07-19', 'Himachal Pradesh', 'Chamba', 125, 20, 85, 14, 1, 'Homes damaged, 3 vehicles washed away'),
('2023-07-19', 'Himachal Pradesh', 'Mandi', 135, 23, 87, 16, 1, 'Village filled with muck, villagers shifted'),
('2023-07-19', 'Himachal Pradesh', 'Kullu', 150, 21, 92, 18, 1, 'Homes/farmlands damaged, road blocked'),
('2023-07-19', 'Himachal Pradesh', 'Kullu', 110, 22, 84, 13, 1, '10 shops damaged'),
('2023-07-20', 'Himachal Pradesh', 'Kullu', 120, 20, 86, 14, 1, 'School building damaged'),
('2023-07-19', 'Himachal Pradesh', 'Mandi', 130, 23, 88, 15, 1, 'Homes/crematorium damaged, hydro project affected'),
('2023-07-20', 'Himachal Pradesh', 'Shimla', 140, 21, 90, 16, 1, '6 homes/50 beegha land damaged'),
('2023-07-20', 'Himachal Pradesh', 'Shimla', 125, 22, 85, 14, 1, 'Apple orchards damaged'),
('2023-07-20', 'Himachal Pradesh', 'Kinnaur', 135, 20, 87, 15, 1, '27 orchards/vehicles washed away'),
('2023-07-21', 'Himachal Pradesh', 'Kullu', 110, 23, 84, 13, 1, '6 homes flooded, 30 evacuated'),
('2023-07-21', 'Himachal Pradesh', 'Mandi', 120, 21, 86, 14, 1, 'Boulders/debris, no new damage detailed'),
('2023-07-22', 'Himachal Pradesh', 'Shimla', 150, 22, 92, 18, 1, '3 deaths, 7 vehicles washed away'),
('2023-07-25', 'Himachal Pradesh', 'Kullu', 130, 20, 88, 15, 1, '1 home/4 shops washed away'),
('2023-07-25', 'Himachal Pradesh', 'Kullu', 140, 23, 90, 16, 1, '3 homes washed away, 100 beegha land damaged'),
('2023-07-26', 'Himachal Pradesh', 'Shimla', 125, 21, 85, 14, 1, '4 houses/school washed away, 21 cattle lost'),
('2023-07-25', 'Himachal Pradesh', 'Chamba', 135, 22, 87, 15, 1, '1 death, hydro project damaged'),
('2023-07-28', 'Himachal Pradesh', 'Kullu', 110, 20, 84, 13, 1, 'Market evacuated, farmlands damaged'),
('2023-07-29', 'Himachal Pradesh', 'Shimla', 120, 23, 86, 14, 1, 'Apple orchards washed away'),
('2023-07-30', 'Himachal Pradesh', 'Lahaul & Spiti', 130, 21, 88, 15, 1, 'Road blocked, traffic jam'),
('2023-08-02', 'Himachal Pradesh', 'Bilaspur', 140, 22, 90, 16, 1, 'School flooded, playground washed away'),
('2023-07-11', 'Uttarakhand', 'Chamoli', 115, 18, 85, 12, 1, 'Bridge washed away, 15 villages cut off'),
('2023-07-15', 'Uttarakhand', 'Chamoli', 125, 19, 88, 14, 1, 'Muck flow, hill slope damaged'),
('2023-07-18', 'Uttarakhand', 'Chamoli', 130, 17, 90, 15, 1, 'Foot bridge washed away'),
('2023-07-18', 'Uttarakhand', 'Pithoragarh', 110, 20, 84, 13, 1, 'Bridge buried under debris'),
('2023-07-20', 'Uttarakhand', 'Not specified', 120, 18, 86, 14, 1, 'Flashflood destruction'),
('2023-07-22', 'Uttarakhand', 'Uttarkashi', 135, 19, 87, 15, 1, 'Vehicles/homes invaded by muck'),
('2023-08-01', 'Uttarakhand', 'Nainital', 140, 20, 89, 16, 1, 'Homes/farmlands/roads damaged'),
('2023-08-08', 'Uttarakhand', 'Pauri Garhwal', 125, 18, 85, 14, 1, 'Highway damaged, vehicles stuck'),
('2023-08-13', 'Uttarakhand', 'Rudraprayag', 130, 19, 88, 15, 1, '1 death, debris burial'),
('2023-08-13', 'Uttarakhand', 'Chamoli', 115, 17, 84, 13, 1, 'Foot bridge damaged, vehicles in flood'),
('2023-08-18', 'Uttarakhand', 'Pauri Garhwal', 120, 20, 86, 14, 1, 'Residential building damaged'),
('2023-09-15', 'Uttarakhand', 'Not specified', 135, 18, 87, 15, 1, 'Crops/farmlands damaged'),
('2024-07-12', 'Himachal Pradesh', 'Multiple', 150, 22, 90, 18, 1, '31 deaths, flash floods'),
('2024-08-01', 'Himachal Pradesh', 'Kullu/Shimla', 140, 21, 88, 16, 1, 'Large-scale devastation, deaths unknown'),
('2024-07-01', 'Himachal Pradesh', 'Manali', 125, 20, 85, 14, 1, 'Cloudburst, roads damaged'),
('2024-06-01', 'Himachal Pradesh', 'Kullu/Kangra', 130, 23, 87, 15, 1, 'Multiple events, damages to infrastructure'),
('2024-08-01', 'Himachal Pradesh', 'Shimla', 145, 22, 89, 17, 1, '33 missing, flash flood'),
('2024-08-01', 'Himachal Pradesh', 'Mandi', 135, 21, 87, 15, 1, '3 deaths, 7 missing'),
('2024-08-01', 'Himachal Pradesh', 'Kullu', 140, 20, 90, 16, 1, '1 death, 9 missing, 11 houses washed away'),
('2023-06-01', 'Himachal Pradesh', 'Shimla', 10, 25, 60, 8, 0, 'No incident (sample non-event day)'),
('2023-09-01', 'Uttarakhand', 'Chamoli', 15, 24, 65, 10, 0, 'No incident'),
('2024-05-01', 'Himachal Pradesh', 'Kullu', 5, 26, 55, 7, 0, 'No incident'),
('2024-09-01', 'Uttarakhand', 'Uttarkashi', 20, 23, 70, 9, 0, 'No incident'),
('2023-10-01', 'Himachal Pradesh', 'Mandi', 0, 28, 50, 5, 0, 'No incident');

-- SQL code to compute thresholds per state for prediction (based on historical cloudburst events)
-- This can be used to predict: if current weather conditions fall within these ranges for a state, there is a high likelihood of cloudburst based on the dataset.
SELECT 
    State,
    MIN(Rainfall_mm) AS min_rainfall,
    MAX(Rainfall_mm) AS max_rainfall,
    MIN(Temp_C) AS min_temp,
    MAX(Temp_C) AS max_temp,
    MIN(Humidity_percent) AS min_humidity,
    MAX(Humidity_percent) AS max_humidity,
    MIN(Wind_kmh) AS min_wind,
    MAX(Wind_kmh) AS max_wind
FROM cloudbursts
WHERE Cloudburst = 1
GROUP BY State;